{"code":"import { isObject } from \"@vue/shared/src\";\r\nimport { track } from \"./effect\";\r\nconst mutableHandlers = {\r\n    get(target, key, recevier) {\r\n        if (key === \"__V_isReactive\" /* IS_REACTIVE */) {\r\n            return true;\r\n        }\r\n        track(target, key);\r\n        // console.log(recevier) -> proxy\r\n        //取值了可以收集effect\r\n        return Reflect.get(target, key, recevier);\r\n    },\r\n    set(target, key, value, recevier) {\r\n        // console.log(recevier) -> proxy\r\n        //改值了可以收集effect\r\n        return Reflect.set(target, key, value, recevier);\r\n    }\r\n};\r\n//弱引用 key 必须是对象 如果key没有被引用可以被自动销毁\r\nconst reactiveMap = new WeakMap();\r\nfunction createReactiveObject(target) {\r\n    /**\r\n     * 判断是否重复代理\r\n     * 默认target已经代理过属性了\r\n     * eg: const state = reactive({}); reactive(state);\r\n    */\r\n    if (target[\"__V_isReactive\" /* IS_REACTIVE */]) {\r\n        return target;\r\n    }\r\n    //判断target是否为object\r\n    if (!isObject(target)) {\r\n        return target;\r\n    }\r\n    /**\r\n     * 判断是否重复代理对象 eg: let obj = { name: zs }; reactive(obj); reactive(obj);\r\n     * 如果缓存中有这个属性了，则直接返回上次的代理\r\n    */\r\n    const exisitingProxy = reactiveMap.get(target);\r\n    if (exisitingProxy) {\r\n        return target;\r\n    }\r\n    const proxy = new Proxy(target, mutableHandlers);\r\n    //将原对象和生成的代理对象设置成映射表\r\n    reactiveMap.set(target, proxy);\r\n    return proxy;\r\n}\r\nexport function reactive(target) {\r\n    return createReactiveObject(target);\r\n}\r\n//# sourceMappingURL=reactive.js.map","references":["D:/code/mini-vue3/packages/shared/src/index.ts","D:/code/mini-vue3/packages/reactivity/src/effect.ts"],"map":"{\"version\":3,\"file\":\"reactive.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../packages/reactivity/src/reactive.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAE,QAAQ,EAAE,MAAM,iBAAiB,CAAA;AAC1C,OAAO,EAAE,KAAK,EAAE,MAAM,UAAU,CAAA;AAMhC,MAAM,eAAe,GAAmC;IACtD,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,QAAQ;QACvB,IAAI,GAAG,uCAA8B,EAAE;YACrC,OAAO,IAAI,CAAA;SACZ;QACD,KAAK,CAAC,MAAM,EAAE,GAAG,CAAC,CAAA;QAClB,iCAAiC;QACjC,eAAe;QACf,OAAO,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,QAAQ,CAAC,CAAA;IAC3C,CAAC;IACD,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,QAAQ;QAC9B,iCAAiC;QACjC,eAAe;QACf,OAAO,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAA;IAClD,CAAC;CACF,CAAA;AAED,iCAAiC;AACjC,MAAM,WAAW,GAAG,IAAI,OAAO,EAAE,CAAA;AAEjC,SAAS,oBAAoB,CAAC,MAAc;IAC1C;;;;MAIE;IACF,IAAK,MAAc,oCAA2B,EAAE;QAC9C,OAAO,MAAM,CAAA;KACd;IAED,mBAAmB;IACnB,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;QACrB,OAAO,MAAM,CAAA;KACd;IAED;;;MAGE;IACF,MAAM,cAAc,GAAG,WAAW,CAAC,GAAG,CAAC,MAAM,CAAC,CAAA;IAC9C,IAAI,cAAc,EAAE;QAClB,OAAO,MAAM,CAAA;KACd;IAED,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC,MAAM,EAAE,eAAe,CAAC,CAAA;IAChD,oBAAoB;IACpB,WAAW,CAAC,GAAG,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;IAE9B,OAAO,KAAK,CAAA;AACd,CAAC;AAED,MAAM,UAAU,QAAQ,CAAC,MAAc;IACrC,OAAO,oBAAoB,CAAC,MAAM,CAAC,CAAA;AACrC,CAAC\"}"}
